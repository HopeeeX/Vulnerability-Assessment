"use client"

import React from "react";
import { MdOutlineSendToMobile } from "react-icons/md";
import { useRouter } from "next/navigation";
import { useAppSelector } from "@/lib/hooks";
import toast from "react-hot-toast";

const page = () => {
    const router = useRouter()
    const access_token = useAppSelector((state) => state.user.access_token)
    async function handleSubmit(event) {
        event.preventDefault();
        const formData = new FormData(event.currentTarget);
        const headers = new Headers()
        headers.append("Authorization", `Bearer ${access_token}`)
        const response = await fetch("/api/verify/", {
            method: "POST",
            headers: headers,
            body: JSON.stringify({
                code: formData.get("code")
            }),
        });
        const data = await response.json();
        if (response.status == 200) {
            toast.success("Successfully logged in.")
        } else {
        toast.error(data.message)
        }
        router.replace("/dashboard")
    }
    return (
        <div className="bg-[#F5F9FA] h-screen flex flex-col justify-center items-center px-[20px]">
            <form method="post" onSubmit={handleSubmit} className="bg-white p-[35px] rounded-lg shadow-md flex flex-col justify-center items-center">
                <div>
                    <MdOutlineSendToMobile size={50} color="#344564" />
                </div>
                <div className="mt-[35px]">
                    <h1 className="text-black text-opacity-60 font-bold text-[20px] text-center">
                        Verification
                    </h1>
                    <h2 className="text-black text-opacity-60 text-[13px] text-center mt-[2px]">
                        Enter the OTP code you received below.
                    </h2>
                </div>
                <div className=" w-full mt-[40px]">
                    <input
                        className="w-[250px] py-[7px] outline-none rounded-md border border-black border-opacity-30 text-[12px] text-black text-opacity-65 text-center"
                        type="text"
                        name="code"
                    />
                </div>
                <div className="mt-[20px]">
                    <button type="submit"
                        className="px-[106px] bg-[#344564] hover:bg-[#222d42] text-center text-[13px] text-white font-bold py-[9px] rounded-md"
                    >
                        Verify
                    </button>
                </div>
            </form>
        </div>
    );
};

export default page;
